apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- gotk-components.yaml
- gotk-sync.yaml
#images:
#  - name: ghcr.io/fluxcd/kustomize-controller
#    newName: somma/kustomize-controller
#    newTag: azidentity3
#  # - name: ghcr.io/fluxcd/source-controller
#  #   newName: somma/source-controller
#  #   newTag: azidentity
#patches:
#  - patch: |-
#      apiVersion: v1
#      kind: ServiceAccount
#      metadata:
#        name: kustomize-controller
#        namespace: flux-system
#        annotations:
#          azure.workload.identity/client-id: "%s"
#        labels:
#          azure.workload.identity/use: "true"
#  - patch: |-
#      apiVersion: apps/v1
#      kind: Deployment
#      metadata:
#        name: kustomize-controller
#        namespace: flux-system
#        labels:
#          azure.workload.identity/use: "true"
#      spec:
#        template:
#          metadata:
#            labels:
#              azure.workload.identity/use: "true"
